<head>
    <script
    src="https://code.jquery.com/jquery-3.2.1.js"
    integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
    crossorigin="anonymous"></script>
    <script type="text/javascript" src="src/imagerepo.js"></script>
    <script type="text/javascript" src="src/simulations.js"></script>
    
    <script type="text/javascript" src="src/objects.js"></script>
    <script type="text/javascript" src="src/renderinterface.js"></script>
    <script type="text/javascript" src="src/world.js"></script>
    <script type="text/javascript" src="src/app.js"></script>
<script type="text/javascript" src="src/renderer.js"></script>
<script type="text/javascript" src="src/utils.js"></script>

</head>

<body>
<canvas id="playground" width="640" height="400"></canvas>

<script>
    window.addEventListener("load", function() {
    
        
        var repo = new CM.ImageRepo();
        var world = new CM.World(10,10, CM.TILECREATOR(repo));
        var cloudSource = new CM.CloudSource(world.getSizeX(), world.getSizeY(), function (startPosX,startPosY)
        {
            var maxX = world.getSizeX();
            var startPos = new CM.Point(startPosX,startPosY);
            var c = new CM.VehicleSprite(new CM.Point(startPos.x,startPos.y), repo.getImage("cloud"),2,1);
                c.setTicker( 
                    function (startPos)
                {
                    var s = startPos;
                    return function (v){
                    v.move(-1,0);
                    if(v.position.x < -500){
                       v.move(s.x+maxX,0);
                        console.log("reset");
                    } 
                    };
                }(startPos));
              return c;
        });
        setTimeout(function (){
            world.addObjects(cloudSource.generateClouds(0.05,0.05));
            var engine = new CM.CloudEngine(new CM.Renderer("playground"),world,repo, new CM.Point(0,0));
        engine.init();
        engine.run();
        },1000)
    
    });

</script>

</body>